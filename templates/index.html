<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">
    <title>Explore Byte Tutorial</title>
    
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Custom styles for this project -->
    <link href="css/explore.css" rel="stylesheet">
  </head>
  
  <body role="document">
    
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container" >
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="about">About This Data Set</a></li>
	    <li><a href="quality">Data Quality</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    
    <div class="container theme-showcase" role="main">
      
      <!-- Main jumbotron for a primary marketing message or call to action -->
      <div class="jumbotron">
	<h1>Exploratory Analysis: Energy and Water Consumption in Allegheny County Municipal Buildings </h1>
        <p>In this Exploratory Analysis Byte I looked at the water and energy consumption of Allegheny county buildings from 2010-2014.
        </p>
        <p> <b>Question:</b> The Question I wanted to answer about this data was what were the trends in energy consumption by Allegeheny County Municipal 
        Buildings from 2010 - 2014.
        </p>
        <p> <b>Findings:</b> I found that Allegheny County's total spending on energy decreased every year from 2010 to 2013, and then increased
        slightly from 2013 to 2014. The data itself had a very large spread due to to the large variation in size of sites/buildings reported. 
        </p>
        <p> **The graphs and tables in the tabs below summarize the data and what I found. Because most of the graphs use the python Plotly API, 
        you may need to reload the page if the graphs do not appear.
        </p>
      </div>
      
      <div class="page-header">
	
      </div> <!-- /page-header -->
   
    
      <ul class="nav nav-tabs">
	    <li class="active"><a data-toggle="tab" href="#home">Sanitized Data</a></li>
	    <li><a data-toggle="tab" href="#menu1">Boxplot</a></li>
	    <li><a data-toggle="tab" href="#menu2">Normal Distribution</a></li>
	    <li><a data-toggle="tab" href="#menu3">Stats</a></li>
	    <li><a data-toggle="tab" href="#menu4">Total Cost</a></li>
	  </ul>
			
	<div class="tab-content">
	    <div id="home" class="tab-pane fade in active">
	      <h3>Data</h3>
	      <p> The raw data can be found <a href="https://www.google.com/fusiontables/DataSource?docid=15CnIT8u1snCOSRYjV3lPrEnUR_5qoGZ1ZhwGytAt">here</a>. </p>
	      <p> The table below represents a snapshot of the data I used for analysis. I removed all instances where the Total Cost ($) was $0 and outliers that I categorized as
	      spending over $1,000,000. </p>
		      <div class="table-responsive">
				  <table class="table table-striped table-hover">
				    <thead class="thead-inverse">
				     <tr> 
				{% for item in headers %}
				         <th>{{ item }}</th>
				{% endfor %}
				     </tr>
				    </thead>
				    <tbody>
				{% for row in content %}
				     <tr>
				  {% for datum in row %}
				            <td>{{ datum }} </td>
				  {% endfor %}
				     </tr>
				{% endfor %}
				    </tbody>
				   </table>
				</div> 
	    </div>
	    <div id="menu1" class="tab-pane fade">
	      <h3>Boxplot (Made with Plotly)</h3>
	      <p> The graphs below represent the spread of all sites for 2010-2014. I saninitized the data by 
	      removing instances where the Total Cost was 0 or greater than 1,000,000. </p>
	     <p> The first plot shows the data wholistically with all outliers shown, the second is the same exact plot but with a zoomed in y-axis. </p>
	     <p> (You may have to reload the page for the plots to load) </p>
	      <div>
			    <iframe width="900" height="800" frameborder="0" scrolling="no" src="https://plot.ly/~ediering/98.embed"></iframe>
			    <iframe width="900" height="800" frameborder="0" scrolling="no" src="https://plot.ly/~ediering/102.embed"></iframe>
	    </div>
	    </div>
	    <div id="menu2" class="tab-pane fade">
	      <h3>Normalized Distribution Plots (Made with Seaborn)</h3>
	      <p>The data skewed right and not normal. There was a very large spread across the data due to the strong variation of size of sites. Some of the larger sites were
	      broken down into multiple sites in the data which also lead to a large spread as well.</p>
	      <img alt="ten" src="templates/images/10.png" />
	      <img alt="ten" src="templates/images/11.png" />
	      <img alt="ten" src="templates/images/12.png" />
	      <img alt="ten" src="templates/images/13.png" />
	      <img alt="ten" src="templates/images/14.png" />
	    </div>
	    
	    <div id="menu3" class="tab-pane fade">
	      <h3>Mean and Median Plots (Made with Plotly)</h3>
	      <p>The first graph shows a scatterplot of 'Total Cost ($)' per site by year.</p>
	      <p>The second graph the mean cost of energy for Allegheny Country Municipal Buildings by year. The graph shows that the mean cost has descreased
	      from 2010 to 2014.</p>
	      <p>The third graph the median cost of energy for Allegheny Country Municipal Buildings by year. The graph shows that the mean cost has descreased
	      from 2010 to 2014.</p>
	      <iframe width="900" height="800" frameborder="0" scrolling="no" src="https://plot.ly/~ediering/116.embed"></iframe>
	      <iframe width="900" height="800" frameborder="0" scrolling="no" src="https://plot.ly/~ediering/118.embed"></iframe>
	    </div>
	    
	  	<div id="menu4" class="tab-pane fade">
	      <h3>Total Cost Overall (Made with Plotly) </h3>
	      <p>The graph shows the total amount of money spent on energy for Allegheny Country Municipal Buildings by year.</p>
	      <iframe width="900" height="800" frameborder="0" scrolling="no" src="https://plot.ly/~ediering/110.embed"></iframe>
	      <iframe width="900" height="800" frameborder="0" scrolling="no" src="https://plot.ly/~ediering/114.embed"></iframe>
	    
		</div>

 </div> <!-- /container -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
	function updateTable(str) {
		console.log("in updateTable");
		console.log(str);

	    // error checking: ignore buttons that don't have a title!
		if (str == "") {
			return;
		}

	    // find the actual button in this document's HTML
		button = document.getElementById(str);
		// for debugging, write its name to the console
		console.log(button.className);
		// check if it is disabled (btn-info)
		if (button.className.includes("btn-info")) {
			// and enable it (btn-primary)
			button.className = "btn btn-space btn-primary";
		} else {
			// otherwise disable it (btn-info)
			button.className = "btn btn-space btn-info";
		}

		// now get all the buttons
		buttons = document.getElementById("headers").children;
		// and collect their names in cols
		cols = [];
		// loop through them
		for (button in buttons) {
			// grab the id (the name we need is there)
			id = buttons[button].id;
			// make sure it isn't null
			if (buttons[button].id != null) {
				// and that the button is selected 
				var isPrimary = buttons[button].className.includes("btn-primary");
				if (isPrimary && (cols.indexOf(id) == -1)) {
					// if so, add it to our array
					cols.push(id);
				}
			}
		}
					
		$.ajax({
			url: '/_update_table',
			dataType: 'json',
			contentType: 'application/json',
			data: JSON.stringify({'cols' : cols}),
			type: 'POST',
			success: function (res, status) {
				console.log("successrunning");
				console.log(res["content"]);
				console.log(res["headers"]);
				var cols = res["headers"];
				var rows = res["content"];

				// get the table, columns and rows
				table = document.getElementById("data");
				headers = document.getElementById("cols");
				body = document.getElementById("rows");

				// delete current contents
				headers.innerHTML='';
				body.innerHTML = '';

				// and put the new information in the table
				for (col in cols) {
					cell = document.createElement("th");
					cell.innerHTML = cols[col];
					headers.appendChild(cell);
				}
				for (row in rows) {
					tr = document.createElement("tr");
					for (item in rows[row]) {
						td = document.createElement("td");
						td.innerHTML = rows[row][item];
						tr.appendChild(td);
					}
					body.appendChild(tr);
				}
			},
			error: function(res, status) {
				// On Error
				alert('error');
			}
		});
	}
				
				   
				   
</script>
</body>
</html>
